///////////////////////////////////////////////////////////
// test.cb
///////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////
// BASIC stub
///////////////////////////////////////////////////////////
#asm
    include "../../../../../../../EndUser/sdcard/sdk/asm/inc/basic_stub.inc"
main:
    jp      _main
#endasm

///////////////////////////////////////////////////////////
// putchar(char c)
///////////////////////////////////////////////////////////
#asm
_putchar:
    push    ix
    ld      ix,0
    add     ix,sp
    ld      a,(ix+4)
    call    $1D94
    ld      sp,ix
    pop     ix
    ret
#endasm

///////////////////////////////////////////////////////////
// puts(char *s)
///////////////////////////////////////////////////////////
puts(char* s) {
    while (*s) {
        putchar(*s);
        s = s + 1;
    }
}

char *s1 = "Hello world!\r\n";
char a[10];
char b[10] = {1,2,3};
char c[20] = "Hello";

int bla[5] = {12345};

///////////////////////////////////////////////////////////
// main()
///////////////////////////////////////////////////////////
main() {
    // *(s1 + 5) = *(s1 + 7) = 'A';

    // putchar(*(c+1));

    // int q;
    // int w;
    
    // FIXME: This produces incorrect code
    // *(bla+2) = *(bla+3) = *bla;

    // puts("Hello world!\r\n");
    c[5] = c[0];
    puts(c);
}
